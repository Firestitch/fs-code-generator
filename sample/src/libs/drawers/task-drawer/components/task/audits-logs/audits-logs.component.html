<div class="audit-logs" fxLayout="column" fxLayoutGap="18px">
  <ng-container *ngFor="let audit of audits">
    <div *ngIf="audit.meta.length">

      <ng-container *ngFor="let meta of audit.meta; let last = last; let first = first;">

        <div fxLayout="row" fxLayoutAlign="start center">

          <div>
            <app-account-image [account]="audit.actor_account" [shortName]="true"></app-account-image>
            <span class="logs">
                <span> {{ meta.verb }} </span>
                <span *ngIf="meta.description"> the {{ meta.description }} </span>
                <ng-container [ngSwitch]="meta.name">
                  <span *ngSwitchCase="'status_id'">to
                    <app-status-pill [object]="meta.object"></app-status-pill>
                  </span>
                  <span *ngSwitchCase="'category_id'">to
                    <app-category-pill [object]="meta.object"></app-category-pill>
                  </span>
                  <span *ngSwitchCase="'type_id'">to
                    <app-type-pill [object]="meta.object"></app-type-pill>
                  </span>
                  <span *ngSwitchCase="'assigned_account_id'">to
                    <app-account-image [object]="meta.object" [shortName]="true"></app-account-image>
                  </span>
                  <span *ngSwitchCase="'priority'">to
                    <app-priority-pill
                      [priority]="meta.value"
                      [showIcon]="false"
                      [showName]="true">
                    </app-priority-pill>
                  </span>
                  <span *ngSwitchCase="'task_id'">to {{ meta.object.name }}</span>
                  <span *ngSwitchCase="'doc_id'">to {{ meta.object.name }}</span>
                  <span *ngSwitchCase="'project_id'">to {{ meta.object.name }}</span>
                  <span *ngSwitchCase="'object_id'">{{ meta.object?.name }}</span>
                  <span *ngSwitchCase="'due_date'">to {{ meta.value | fsDateFormat }}</span>
                </ng-container>
                <span *ngIf="!last">, </span>
                <small *ngIf="last" class="date">{{ audit.date | fsDateAgo: 'date-yearless'}}</small>
            </span>
          </div>

          <div fxFlex fxLayoutAlign="end">
            <fs-menu *ngIf="meta.name === 'comment_id' && last">
              <ng-template fs-menu-item (click)="edit(audit, meta)">
                Edit
              </ng-template>
              <ng-template fs-menu-item (click)="remove(audit)">
                Delete
              </ng-template>
            </fs-menu>
          </div>

        </div>

        <div>
          <!-- Hiding for now, this wspanill show up in the content version system. This will reference the version number at some point.
            <ng-container *ngIf="log.parent === 'content'">
            <small>
              {{ log.value | json }}
              <div fsEditorRenderer [ngModel]="log.value"></div>
            </small>
          </ng-container> -->

          <div *ngIf="meta.name === 'comment_id'" class="comment">
            <div fsEditorRenderer [ngModel]="meta.object.meta.content"></div>
          </div>
        </div>

      </ng-container>

    </div>
  </ng-container>
</div>
